<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>MCP Orchestration System: Production-Oriented Agent Control Plane | Yuxin Fan</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="A production-oriented MCP (Model Control Plane) orchestration system designed to manage agentic workflows with statefulness, extensibility, cost control, and multi-step reasoning capabilities.">
    <meta name="generator" content="Hugo 0.143.0">
    
    
    
    
      <meta name="robots" content="index, follow">
    
    

    
<link rel="stylesheet" href="https://yx-fan.github.io/ananke/css/main.min.82f975b026e5b08266c1d72690771f06d83031dfbd2d0ffba4616d9ef0d1df91.css" >



    
    
    <link rel="stylesheet" href="https://yx-fan.github.io/css/shared.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script>
      
      const firebaseConfig = {
        apiKey: "AIzaSyDkOKW_GzV0dBjgGLYE6ASMYB1WLLrjD4M",
        authDomain: "yx-fan-website.firebaseapp.com",
        databaseURL: "https://yx-fan-website-default-rtdb.firebaseio.com",
        projectId: "yx-fan-website",
        storageBucket: "yx-fan-website.firebasestorage.app",
        messagingSenderId: "76941092208",
        appId: "1:76941092208:web:8cd643195ef05a6dd09bb5",
        measurementId: "G-XDZ9H5W5QX"
      };
      
      
      firebase.initializeApp(firebaseConfig);
    </script>
    
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4KY4X96MYQ"></script>
<script>
   window.dataLayer = window.dataLayer || [];
   function gtag(){dataLayer.push(arguments);}
   gtag('js', new Date());

   
   gtag('config', 'G-4KY4X96MYQ', {
     
     page_type: 'projects',
     
     content_category: 'projects',
     
     custom_map: {
       'dimension1': 'page_type',
       'dimension2': 'content_category'
     }
   });
</script>

<script>

(function() {
  'use strict';
  
  
  document.addEventListener('DOMContentLoaded', function() {
    
    const projectCards = document.querySelectorAll('.project-card a[href]');
    projectCards.forEach(function(card) {
      card.addEventListener('click', function(e) {
        const projectTitle = this.closest('.project-card')?.querySelector('h2 a')?.textContent || 'Unknown';
        if (typeof gtag !== 'undefined') {
          gtag('event', 'project_click', {
            'event_category': 'engagement',
            'event_label': projectTitle,
            'value': 1
          });
        }
      });
    });
    
    
    const tagItems = document.querySelectorAll('.tag-item');
    tagItems.forEach(function(tag) {
      tag.addEventListener('click', function(e) {
        const tagName = this.querySelector('.tag-name')?.textContent || 'Unknown';
        if (typeof gtag !== 'undefined') {
          gtag('event', 'tag_click', {
            'event_category': 'navigation',
            'event_label': tagName,
            'value': 1
          });
        }
      });
    });
    
    
    const externalLinks = document.querySelectorAll('a[href^="http"]:not([href*="' + window.location.hostname + '"])');
    externalLinks.forEach(function(link) {
      link.addEventListener('click', function(e) {
        const linkUrl = this.href;
        const linkText = this.textContent.trim() || linkUrl;
        if (typeof gtag !== 'undefined') {
          gtag('event', 'external_link_click', {
            'event_category': 'outbound',
            'event_label': linkText,
            'transport_type': 'beacon',
            'event_callback': function() {
              
            }
          });
        }
      });
    });
    
    
    const tagSearchInput = document.getElementById('tagSearch');
    if (tagSearchInput) {
      let searchTimeout;
      tagSearchInput.addEventListener('input', function(e) {
        clearTimeout(searchTimeout);
        const searchTerm = e.target.value.trim();
        if (searchTerm.length > 2) {
          searchTimeout = setTimeout(function() {
            if (typeof gtag !== 'undefined') {
              gtag('event', 'tag_search', {
                'event_category': 'search',
                'search_term': searchTerm,
                'value': 1
              });
            }
          }, 1000); 
        }
      });
    }
    
    
    let scrollDepthTracked = {
      25: false,
      50: false,
      75: false,
      100: false
    };
    
    function trackScrollDepth() {
      const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
      const docHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrollPercent = Math.round((scrollTop / docHeight) * 100);
      
      [25, 50, 75, 100].forEach(function(threshold) {
        if (scrollPercent >= threshold && !scrollDepthTracked[threshold]) {
          scrollDepthTracked[threshold] = true;
          if (typeof gtag !== 'undefined') {
            gtag('event', 'scroll_depth', {
              'event_category': 'engagement',
              'event_label': threshold + '%',
              'value': threshold
            });
          }
        }
      });
    }
    
    
    let scrollTimeout;
    window.addEventListener('scroll', function() {
      if (scrollTimeout) {
        window.cancelAnimationFrame(scrollTimeout);
      }
      scrollTimeout = window.requestAnimationFrame(trackScrollDepth);
    });
    
    
    let timeOnPageTracked = false;
    setTimeout(function() {
      if (!timeOnPageTracked) {
        timeOnPageTracked = true;
        if (typeof gtag !== 'undefined') {
          gtag('event', 'time_on_page', {
            'event_category': 'engagement',
            'event_label': '30_seconds',
            'value': 30
          });
        }
      }
    }, 30000);
    
    
    const logEntries = document.querySelectorAll('.log-entry a[href]');
    logEntries.forEach(function(entry) {
      entry.addEventListener('click', function(e) {
        const logTitle = this.textContent.trim() || 'Unknown';
        if (typeof gtag !== 'undefined') {
          gtag('event', 'log_entry_click', {
            'event_category': 'engagement',
            'event_label': logTitle,
            'value': 1
          });
        }
      });
    });
    
    
    const tickerCards = document.querySelectorAll('.ticker-card a[href]');
    tickerCards.forEach(function(card) {
      card.addEventListener('click', function(e) {
        const tickerTitle = this.querySelector('.ticker-title')?.textContent?.trim() || 'Unknown';
        if (typeof gtag !== 'undefined') {
          gtag('event', 'ticker_card_click', {
            'event_category': 'engagement',
            'event_label': tickerTitle,
            'value': 1
          });
        }
      });
    });
    
    
    const tickerTrack = document.getElementById('tickerTrack');
    if (tickerTrack) {
      let dragStartTime = null;
      let dragDistance = 0;
      let lastX = 0;
      
      tickerTrack.addEventListener('mousedown', function(e) {
        dragStartTime = Date.now();
        lastX = e.pageX;
        dragDistance = 0;
      });
      
      document.addEventListener('mousemove', function(e) {
        if (dragStartTime !== null) {
          dragDistance += Math.abs(e.pageX - lastX);
          lastX = e.pageX;
        }
      });
      
      document.addEventListener('mouseup', function() {
        if (dragStartTime !== null && dragDistance > 50) {
          const dragDuration = Date.now() - dragStartTime;
          if (typeof gtag !== 'undefined') {
            gtag('event', 'ticker_drag', {
              'event_category': 'interaction',
              'event_label': 'ticker_scroll',
              'value': Math.round(dragDistance / 100), 
              'custom_parameter': {
                'duration_ms': dragDuration
              }
            });
          }
        }
        dragStartTime = null;
        dragDistance = 0;
      });
    }
    
    
    const viewAllLogLink = document.querySelector('.ticker-view-all');
    if (viewAllLogLink) {
      viewAllLogLink.addEventListener('click', function(e) {
        if (typeof gtag !== 'undefined') {
          gtag('event', 'view_all_log_click', {
            'event_category': 'navigation',
            'event_label': 'homepage_to_log',
            'value': 1
          });
        }
      });
    }
  });
})();
</script>

    
      
<link rel="apple-touch-icon" sizes="180x180" href="https://yx-fan.github.io/favicon_io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://yx-fan.github.io/favicon_io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://yx-fan.github.io/favicon_io/favicon-16x16.png">
<link rel="manifest" href="https://yx-fan.github.io/favicon_io/site.webmanifest">
<link rel="shortcut icon" href="https://yx-fan.github.io/favicon_io/favicon.ico">


    

    

    
      <link rel="canonical" href="https://yx-fan.github.io/projects/mcp-orchestration-system/">
    

    <meta property="og:url" content="https://yx-fan.github.io/projects/mcp-orchestration-system/">
  <meta property="og:site_name" content="Yuxin Fan">
  <meta property="og:title" content="MCP Orchestration System: Production-Oriented Agent Control Plane">
  <meta property="og:description" content="A production-oriented MCP (Model Control Plane) orchestration system designed to manage agentic workflows with statefulness, extensibility, cost control, and multi-step reasoning capabilities.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="projects">
    <meta property="article:published_time" content="2026-02-05T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-02-05T00:00:00+00:00">
    <meta property="article:tag" content="System Design">
    <meta property="article:tag" content="AI Orchestration">
    <meta property="article:tag" content="LLM">
    <meta property="article:tag" content="LangGraph">
    <meta property="article:tag" content="Redis">
    <meta property="article:tag" content="Vector Database">

  <meta itemprop="name" content="MCP Orchestration System: Production-Oriented Agent Control Plane">
  <meta itemprop="description" content="A production-oriented MCP (Model Control Plane) orchestration system designed to manage agentic workflows with statefulness, extensibility, cost control, and multi-step reasoning capabilities.">
  <meta itemprop="datePublished" content="2026-02-05T00:00:00+00:00">
  <meta itemprop="dateModified" content="2026-02-05T00:00:00+00:00">
  <meta itemprop="wordCount" content="1401">
  <meta itemprop="keywords" content="System Design,AI Orchestration,LLM,LangGraph,Redis,Vector Database,Microservices">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="MCP Orchestration System: Production-Oriented Agent Control Plane">
  <meta name="twitter:description" content="A production-oriented MCP (Model Control Plane) orchestration system designed to manage agentic workflows with statefulness, extensibility, cost control, and multi-step reasoning capabilities.">

	
  </head>

  <body class="ma0 avenir bg-near-white production">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://yx-fan.github.io/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Yuxin Fan
      
    </a>
    <div class="flex-l items-center nav-right-section">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://yx-fan.github.io/" title="Home page">
              Home
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://yx-fan.github.io/about/" title="About Me page">
              About Me
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://yx-fan.github.io/log/" title="Log page">
              Log
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://yx-fan.github.io/projects/" title="Projects page">
              Projects
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="https://yx-fan.github.io/tags/" title="Tags page">
              Tags
            </a>
          </li>
          
        </ul>
      
      
<div class="ananke-socials">
  
    
    <a href="https://www.linkedin.com/in/fanyuxin/" target="_blank" rel="noopener" class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>

      
<div class="like-button-compact-container" id="likeContainerCompact">
  <button class="like-button-compact" id="likeButtonCompact" aria-label="Like this page">
    <span class="like-icon-compact">üëç</span>
    <span class="like-count-compact" id="likeCountCompact">0</span>
  </button>
  <div class="like-particles-compact" id="likeParticlesCompact"></div>
  <div class="thank-you-message-compact" id="thankYouMessageCompact">
    <span class="thank-you-text-compact"></span>
  </div>
</div>

<style>
.like-button-compact-container {
  position: relative;
  display: inline-flex;
  align-items: center;
  margin-left: 1rem;
  flex-shrink: 0;
  overflow: visible;
}

.like-button-compact {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.4rem 0.75rem;
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  color: white;
  font-size: 0.875rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

.like-button-compact:hover {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.3);
  transform: translateY(-1px);
}

.like-button-compact:active {
  transform: translateY(0) scale(0.95);
}

.like-button-compact.clicked {
  background: rgba(255, 107, 157, 0.2);
  border-color: rgba(255, 107, 157, 0.4);
}

.like-icon-compact {
  font-size: 1rem;
  transition: transform 0.3s ease;
  display: inline-block;
}

.like-button-compact.clicked .like-icon-compact {
  animation: heartBeatCompact 0.6s ease-in-out;
}

@keyframes heartBeatCompact {
  0%, 100% { transform: scale(1); }
  25% { transform: scale(1.3) rotate(-5deg); }
  50% { transform: scale(1.2) rotate(5deg); }
  75% { transform: scale(1.3) rotate(-3deg); }
}

.like-count-compact {
  font-size: 0.875rem;
  font-weight: 600;
  min-width: 1.5rem;
  text-align: center;
}

.like-particles-compact {
  position: absolute;
  top: 50%;
  left: 50%;
  pointer-events: none;
  z-index: 0;
}

.thank-you-message-compact {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) translateY(-80px);
  opacity: 0;
  pointer-events: none;
  z-index: 10000;
  transition: opacity 0.4s ease, transform 0.4s ease;
  will-change: opacity, transform;
}

.thank-you-message-compact.show {
  opacity: 1;
  transform: translate(-50%, -50%) translateY(-100px);
}

.thank-you-text-compact {
  display: inline-block;
  padding: 0.4rem 1rem;
  background: linear-gradient(135deg, rgba(107, 207, 127, 0.95) 0%, rgba(91, 127, 168, 0.95) 100%);
  color: white;
  font-size: 0.8rem;
  font-weight: 600;
  border-radius: 20px;
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
  white-space: nowrap;
  backdrop-filter: blur(10px);
}

.thank-you-message-compact.show .thank-you-text-compact {
  animation: thankYouPulseCompact 0.5s ease-out;
}

@keyframes thankYouPulseCompact {
  0% {
    transform: scale(0.8);
  }
  50% {
    transform: scale(1.1);
  }
  100% {
    transform: scale(1);
  }
}

.particle-compact {
  position: absolute;
  width: 4px;
  height: 4px;
  background: #ff6b9d;
  border-radius: 50%;
  pointer-events: none;
  animation: particleFloatCompact 1.5s ease-out forwards;
  box-shadow: 0 0 4px rgba(255, 107, 157, 0.8);
}

.particle-compact:nth-child(odd) {
  background: #ffd93d;
  box-shadow: 0 0 4px rgba(255, 217, 61, 0.8);
}

.particle-compact:nth-child(3n) {
  background: #6bcf7f;
  box-shadow: 0 0 4px rgba(107, 207, 127, 0.8);
}

@keyframes particleFloatCompact {
  0% {
    opacity: 1;
    transform: translate(-50%, -50%) scale(1) rotate(0deg);
  }
  50% {
    opacity: 0.8;
  }
  100% {
    opacity: 0;
    transform: translate(-50%, -50%) translateY(-80px) translateX(calc(var(--random-x) * 1px)) scale(0) rotate(720deg);
  }
}

@media (max-width: 768px) {
  .like-button-compact-container {
    margin-left: 0.5rem;
    margin-top: 0;
  }
  
  .like-button-compact {
    padding: 0.35rem 0.6rem;
    font-size: 0.75rem;
    gap: 0.3rem;
    min-width: auto;
  }
  
  .like-icon-compact {
    font-size: 0.875rem;
    line-height: 1;
  }
  
  .like-count-compact {
    font-size: 0.7rem;
    min-width: 1.2rem;
  }
}

@media (max-width: 480px) {
  .like-button-compact-container {
    margin-left: 0.25rem;
  }
  
  .like-button-compact {
    padding: 0.3rem 0.5rem;
    font-size: 0.7rem;
    gap: 0.25rem;
  }
  
  .like-icon-compact {
    font-size: 0.8rem;
  }
  
  .like-count-compact {
    font-size: 0.65rem;
    min-width: 1rem;
  }
}
</style>

<script>
(function() {
  'use strict';
  
  const likeButton = document.getElementById('likeButtonCompact');
  const likeCount = document.getElementById('likeCountCompact');
  const likeParticles = document.getElementById('likeParticlesCompact');
  const thankYouMessage = document.getElementById('thankYouMessageCompact');
  const thankYouText = thankYouMessage.querySelector('.thank-you-text-compact');
  
  
  const thankYouMessages = [
    'Thanks! üôè',
    'Thank you! ‚ù§Ô∏è',
    'Appreciate it! ‚ú®',
    'Much appreciated! üåü',
    'Thanks a lot! üíô',
    'You\'re awesome! üéâ',
    'Thank you so much! üåà'
  ];
  
  if (typeof firebase === 'undefined') {
    console.error('Firebase is not loaded');
    return;
  }
  
  const database = firebase.database();
  const likesRef = database.ref('likes/homepage');
  let currentCount = 0;
  let isUpdating = false;
  let skipListenerUpdate = false;
  
  const RATE_LIMIT_MS = 1000;
  const LAST_CLICK_KEY = 'lastLikeClickCompact';
  
  function canClick() {
    const lastClick = localStorage.getItem(LAST_CLICK_KEY);
    if (!lastClick) return true;
    const timeSinceLastClick = Date.now() - parseInt(lastClick, 10);
    return timeSinceLastClick >= RATE_LIMIT_MS;
  }
  
  function recordClick() {
    localStorage.setItem(LAST_CLICK_KEY, Date.now().toString());
  }
  
  likesRef.once('value', (snapshot) => {
    const count = snapshot.val();
    currentCount = count || 0;
    likeCount.textContent = currentCount.toLocaleString();
  }, (error) => {
    console.error('Error loading likes:', error);
    likeCount.textContent = '0';
  });
  
  likesRef.on('value', (snapshot) => {
    if (skipListenerUpdate) {
      return;
    }
    const count = snapshot.val();
    if (count !== null && count !== undefined) {
      currentCount = count;
      likeCount.textContent = currentCount.toLocaleString();
    }
  }, (error) => {
    console.error('Error listening to likes:', error);
  });
  
  function createParticles(count = 10) {
    for (let i = 0; i < count; i++) {
      const particle = document.createElement('div');
      particle.className = 'particle-compact';
      
      const angle = (Math.PI * 2 * i) / count;
      const distance = 15 + Math.random() * 15;
      const x = Math.cos(angle) * distance;
      const y = Math.sin(angle) * distance;
      const randomX = (Math.random() - 0.5) * 60;
      
      particle.style.left = `calc(50% + ${x}px)`;
      particle.style.top = `calc(50% + ${y}px)`;
      particle.style.animationDelay = `${Math.random() * 0.2}s`;
      particle.style.setProperty('--random-x', randomX);
      
      likeParticles.appendChild(particle);
      
      setTimeout(() => {
        particle.remove();
      }, 1500);
    }
  }
  
  
  function showThankYouMessage() {
    if (!thankYouMessage || !thankYouText) {
      console.error('Thank you message elements not found');
      return;
    }
    
    
    const buttonRect = likeButton.getBoundingClientRect();
    const centerX = buttonRect.left + buttonRect.width / 2;
    const centerY = buttonRect.top + buttonRect.height / 2;
    
    
    thankYouMessage.classList.remove('show');
    
    
    const randomMessage = thankYouMessages[Math.floor(Math.random() * thankYouMessages.length)];
    thankYouText.textContent = randomMessage;
    
    
    thankYouMessage.style.left = centerX + 'px';
    thankYouMessage.style.top = (centerY - 60) + 'px';
    thankYouMessage.style.display = 'block';
    thankYouMessage.style.position = 'fixed';
    thankYouMessage.style.transform = 'translate(-50%, -50%)';
    
    
    void thankYouMessage.offsetHeight;
    
    
    requestAnimationFrame(() => {
      thankYouMessage.classList.add('show');
      thankYouMessage.style.transform = 'translate(-50%, -50%) translateY(-20px)';
      console.log('Thank you message shown:', randomMessage);
    });
    
    
    setTimeout(() => {
      if (thankYouMessage) {
        thankYouMessage.classList.remove('show');
        setTimeout(() => {
          thankYouMessage.style.display = 'none';
        }, 400);
      }
    }, 2500);
  }
  
  likeButton.addEventListener('click', function(e) {
    e.preventDefault();
    
    if (isUpdating) {
      return;
    }
    
    isUpdating = true;
    skipListenerUpdate = true;
    
    this.classList.add('clicked');
    
    if (!canClick()) {
      isUpdating = false;
      skipListenerUpdate = false;
      this.classList.remove('clicked');
      return;
    }
    
    recordClick();
    
    likesRef.once('value', (snapshot) => {
      const currentValue = snapshot.val() || 0;
      const newValue = currentValue + 1;
      
      likesRef.set(newValue)
        .then(() => {
          currentCount = newValue;
          likeCount.textContent = newValue.toLocaleString();
          
          setTimeout(() => {
            skipListenerUpdate = false;
          }, 100);
          
          createParticles(10);
          
          
          setTimeout(() => {
            showThankYouMessage();
          }, 100);
          
          if (typeof gtag !== 'undefined') {
            gtag('event', 'page_like', {
              'event_category': 'engagement',
              'event_label': 'homepage',
              'value': newValue,
              'like_count': newValue,
              'non_interaction': false
            });
          } else if (typeof window.dataLayer !== 'undefined') {
            window.dataLayer.push({
              'event': 'page_like',
              'event_category': 'engagement',
              'event_label': 'homepage',
              'value': newValue,
              'like_count': newValue
            });
          }
          
          setTimeout(() => {
            this.classList.remove('clicked');
            isUpdating = false;
          }, 600);
        })
        .catch((error) => {
          console.error('Error updating likes:', error);
          isUpdating = false;
          skipListenerUpdate = false;
          this.classList.remove('clicked');
        });
    }, (error) => {
      console.error('Error reading current value:', error);
      isUpdating = false;
      skipListenerUpdate = false;
      this.classList.remove('clicked');
    });
  });
})();
</script>


    </div>
  </div>
</nav>

<style>
 
@media (max-width: 768px) {
  nav .nav-right-section {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.5rem;
    justify-content: flex-end;
  }
  
  nav .nav-right-section ul {
    width: 100%;
    order: -1;
    margin-bottom: 0.5rem;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
  }
  
  nav .nav-right-section ul li {
    margin: 0;
    padding: 0;
  }
  
  nav .nav-right-section ul li a {
    padding: 0.25rem 0.5rem;
    font-size: 0.875rem;
  }
}

@media (max-width: 480px) {
  nav .nav-right-section {
    gap: 0.25rem;
  }
  
  nav .nav-right-section ul {
    gap: 0.25rem;
    margin-bottom: 0.25rem;
  }
  
  nav .nav-right-section ul li a {
    font-size: 0.8rem;
    padding: 0.2rem 0.4rem;
  }
}
</style>


    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked ttu">
          
        My Projects
      </aside>
      









  







  <div id="sharing" class="mt3 ananke-socials">
    
      
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://yx-fan.github.io/projects/mcp-orchestration-system/&amp;title=MCP%20Orchestration%20System:%20Production-Oriented%20Agent%20Control%20Plane" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn">
        
        <span class="icon"> <svg style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span>
        
      </a>
    
  </div>



      <h1 class="f1 athelas mt3 mb1">MCP Orchestration System: Production-Oriented Agent Control Plane</h1>
      
      
      
      <time class="f6 mv4 dib tracked" datetime="2026-02-05T00:00:00Z">February 5, 2026</time>
      

      
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h3 id="1-overview">1. Overview</h3>
<p>As large language models become increasingly capable, many systems treat them as the center of the architecture: a single prompt in, a single response out. While this approach is sufficient for demos, it quickly breaks down in production settings that require statefulness, extensibility, cost control, and multi-step reasoning.</p>
<p>This project implements a production-oriented MCP (Model Control Plane) orchestration system designed to manage agentic workflows in a structured, observable, and evolvable manner.</p>
<p>Rather than framing the system as &ldquo;an AI agent,&rdquo; it is deliberately designed as a control plane that coordinates intent understanding, workflow planning, conditional execution, state and memory management, and post-execution validation and persistence.</p>
<p>The core philosophy of this project is that agent behavior is a system concern, not a prompt engineering problem.</p>
<hr>
<h3 id="2-architecture-design">2. Architecture Design</h3>
<p>At a high level, the system is composed of five conceptual layers: API Layer, MCP Control Plane, Workflow Layer, Execution Layer, and State &amp; Memory Layer. Each layer has a clearly defined responsibility and interacts with adjacent layers through explicit contracts rather than implicit coupling.</p>
<p><img src="https://yx-fan.github.io/images/MCP_Orchestration_Architecture.png" alt="MCP Orchestration Architecture"></p>
<p>The orchestration flow is strictly top-down, while state and memory operate as managed side channels rather than being embedded directly into execution logic.</p>
<h4 id="api-layer">API Layer</h4>
<p>The API layer provides a single, stable entry point for all user interactions via a <code>/chat</code> endpoint. Its responsibilities are intentionally limited to request validation, session management, metadata normalization, and error boundary enforcement. The API layer does not perform any business logic, intent classification, or agent invocation. This separation ensures that external interface stability is preserved even as internal workflows evolve.</p>
<p>The layer is built using Node.js and Express for the RESTful API framework, with cookie-based or token-based session tracking and schema validation middleware (e.g., Joi, Zod) for request validation.</p>
<h4 id="mcp-control-plane">MCP Control Plane</h4>
<p>At the center of the system is the MCP Orchestrator, which acts as a single control plane for all request lifecycles. The control plane is responsible for pre-processing and normalization hooks (query sanitization, context enrichment), intent resolution using a multi-tier strategy (rule ‚Üí LLM ‚Üí default), workflow selection and planning (dynamic workflow graph construction), state hydration and persistence (session state management), and post-processing and response assembly (result validation and formatting).</p>
<p>This design avoids the common pitfall of &ldquo;agent sprawl,&rdquo; where individual agents independently manage memory, routing, and execution decisions. All coordination logic is centralized, observable, and testable. Key components include the Orchestrator (main coordination engine), Intent Router (three-tier intent resolution system), Pre/Post-Process Hooks (extensible processing pipeline), and State Manager (session and workflow state coordination).</p>
<p>Intent understanding is treated as a routing problem, not a generative one. The system applies a deterministic, cost-aware, three-level strategy: rule-based matching for high-confidence, low-latency cases (e.g., keyword matching, regex patterns), LLM-based semantic classification for ambiguous queries requiring semantic understanding, and explicit default fallback to guarantee forward progress under uncertainty. By making intent resolution explicit, the system avoids hidden prompt branching and ensures predictable behavior under failure or uncertainty.</p>
<h4 id="workflow-layer">Workflow Layer</h4>
<p>A critical design decision in this system is the strict separation between workflow planning and workflow execution. The Workflow Planner (LangGraph Builder) dynamically constructs a workflow graph based on resolved intent, domain-specific configuration, and conditional execution rules. This planning phase is declarative and configuration-driven, enabling workflows to be modified without touching execution code.</p>
<p>The Workflow Runtime executes the compiled graph asynchronously, handling node sequencing, conditional routing, and state propagation between nodes. This separation allows planning-time decisions to remain stable while execution-time behavior adapts dynamically to runtime state. The layer uses LangGraph for workflow graph construction and execution, async/await for non-blocking execution, and YAML/JSON for configuration-driven workflow definitions.</p>
<h4 id="execution-layer">Execution Layer</h4>
<p>Execution is performed by Agents and Nodes, each designed as a focused, side-effect-aware component. Examples include question type analysis nodes (classify question types: factual, analytical, creative), entity or context resolution nodes (extract and resolve entities from queries), RAG retrieval nodes (semantic search and retrieval from vector store), answer synthesis nodes (generate responses using LLM), and reflection or evaluation nodes (quality assessment and validation).</p>
<p>Nodes operate on a shared state object but do not own persistence, routing, or lifecycle concerns. This keeps execution logic composable and easy to reason about. LLM interactions are treated as external dependencies, not architectural anchors. Node types include QA Nodes for question-answering workflows, RAG Nodes for retrieval-augmented generation, Tool Nodes for external API integrations, and Reflection Nodes for self-evaluation and quality checks.</p>
<h4 id="state--memory">State &amp; Memory</h4>
<p>State management is explicitly divided into two categories. Session State and Conversation History are managed in Redis, used for session-scoped persistent state, multi-turn conversation history, and workflow continuity across requests. Temporary execution fields are explicitly filtered and never persisted, preventing state pollution.</p>
<p>Vector Store is used exclusively for retrieval-augmented generation, long-term semantic memory, and domain-specific document grounding. The orchestrator determines when and how vector memory is accessed‚Äîexecution nodes never fetch memory autonomously. Technologies include Redis for session state, conversation history, and temporary caching; Vector Database (e.g., Milvus, Pinecone, Weaviate) for semantic search; and JSON-based state serialization.</p>
<hr>
<h3 id="3-design-challenges-and-solutions">3. Design Challenges and Solutions</h3>
<h4 id="centralized-orchestration-vs-distributed-autonomy">Centralized Orchestration vs. Distributed Autonomy</h4>
<p>Distributed agent autonomy is attractive conceptually but fragile operationally. Without centralized control, it&rsquo;s difficult to enforce consistent policies, maintain observability, and handle errors uniformly. The solution is to centralize all orchestration logic in the MCP Orchestrator, with agents and nodes operating as pure functions without autonomous routing or memory access. All coordination decisions flow through a single control plane.</p>
<h4 id="workflow-configuration-vs-hard-coded-logic">Workflow Configuration vs. Hard-Coded Logic</h4>
<p>Hard-coding workflow logic makes experimentation expensive and domain expansion difficult. The system uses declarative configuration (YAML/JSON) to define workflows, separates workflow planning from execution, and enables runtime workflow graph construction based on intent and configuration.</p>
<h4 id="state-scoping-and-memory-management">State Scoping and Memory Management</h4>
<p>Mixing temporary execution state with persistent session state leads to memory leaks, unintended coupling, and long-term drift. The solution explicitly separates session state (Redis) from execution state (in-memory), filters temporary fields before persistence, and uses vector store exclusively for RAG and long-term memory, not session state.</p>
<h4 id="cost-control-and-llm-usage">Cost Control and LLM Usage</h4>
<p>Uncontrolled LLM invocations lead to unpredictable costs and latency. The system implements tiered intent resolution (use rules first, LLM only when necessary), explicit LLM invocation points rather than implicit prompt branching, and cost tracking and budget enforcement at the orchestrator level.</p>
<h4 id="system-evolution-and-extensibility">System Evolution and Extensibility</h4>
<p>Adding new agents, tools, or workflows should not require restructuring the core architecture. The system achieves this through plugin-based node architecture, configuration-driven workflow definitions, clear extension points (hooks, nodes, intent handlers), and backward-compatible API contracts.</p>
<hr>
<h3 id="4-key-engineering-decisions">4. Key Engineering Decisions</h3>
<p>Orchestration is centralized by design. Distributed agent autonomy is attractive conceptually but fragile operationally. Centralizing orchestration enables consistent policy enforcement, observability, and error handling.</p>
<p>Workflows are configuration, not code. Workflow graphs are driven by declarative configuration rather than hard-coded logic. This dramatically lowers the cost of experimentation and domain expansion.</p>
<p>State is explicitly scoped. By separating temporary execution state from persistent session state, the system avoids memory leaks, unintended coupling, and long-term drift.</p>
<p>LLMs are dependencies, not the system. LLMs are invoked deliberately and contextually. They do not control routing, memory access, or lifecycle decisions.</p>
<p>The system is designed to evolve. New agents, tools, memory backends, and workflow patterns can be introduced without restructuring the core architecture.</p>
<hr>
<h3 id="5-scalability-and-future-development">5. Scalability and Future Development</h3>
<p>The MCP orchestration system is designed for production-scale deployment and continuous evolution. Scalability features include horizontal scaling through stateless orchestrator design enabling multi-instance deployment, async execution with non-blocking workflow runtime supporting high concurrency, caching strategy using Redis to reduce redundant LLM calls and database queries, and load balancing via API Gateway distributing traffic across orchestrator instances.</p>
<p>Future enhancements include multi-modal support to extend nodes for handling images, audio, and video, advanced reflection with self-correction and iterative improvement loops, domain-specific workflows with industry-specific workflow templates, observability dashboard for real-time monitoring of workflow execution and costs, and A/B testing framework to compare workflow variations for optimization.</p>
<hr>
<h3 id="6-conclusion">6. Conclusion</h3>
<p>This project demonstrates that scalable agentic systems require control planes, not clever prompts. By treating intent resolution, workflow planning, execution, and memory as separate but coordinated responsibilities, the MCP architecture provides a robust foundation for building complex, multi-step AI systems that remain understandable, testable, and extensible.</p>
<p>The resulting system is not a chatbot‚Äîit is an agent orchestration platform capable of supporting diverse domains, evolving workflows, and production-level operational constraints. The architecture&rsquo;s emphasis on explicit contracts, centralized orchestration, and configuration-driven workflows ensures that the system can evolve without becoming unmaintainable, making it suitable for production environments where reliability, observability, and cost control are paramount.</p>
<ul class="pa0">
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/system-design/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">System Design</a>
   </li>
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/ai-orchestration/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">AI Orchestration</a>
   </li>
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/llm/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">LLM</a>
   </li>
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/langgraph/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">LangGraph</a>
   </li>
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/redis/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Redis</a>
   </li>
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/vector-database/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Vector Database</a>
   </li>
  
   <li class="list di">
     <a href="https://yx-fan.github.io/tags/microservices/" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Microservices</a>
   </li>
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-30-l mt6-l">




  <div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links">
    <p class="f5 b mb3">Related</p>
    <ul class="pa0 list">
	   
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/chat-platform-system-design-core-project/">CoolChat Platform System Design: Scalable and Secure Chat Architecture</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/log/redis-sorted-sets-recent-search-history/">Using Redis Sorted Sets for Recent User Search History</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/semantic-search-system-milvus-reranking/">Building a Production-Oriented Semantic Search System with Milvus and Cross-Encoder Reranking</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/log/distributed-lock-vs-row-lock-vs-transaction/">Distributed Lock vs Row Lock vs Transaction</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/log/how-nodejs-achieves-high-concurrency/">How Node.js Achieves High Concurrency on a Single CPU Core</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/cluster-based-summarization-system/">Cluster-Based Summarization System: Scalable Text Clustering and Summarization Pipeline</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/log/opensearch-shouldnt-be-primary-database/">Why OpenSearch Shouldn&#39;t Be Used as a Primary Database</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/log/sql-in-the-ai-era/">SQL in the AI Era</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/chat-group-core/">Group Chat Architecture and Implementation</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/chat-one-to-one-core/">One-to-One Chat Architecture and Implementation</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/travel-expense-tracker-backend-system-core/">Travel Expense Tracker Backend System</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/msg-queue-microservice-project/">Message Queue Microservice: Building a Scalable gRPC and RabbitMQ-Based Solution</a>
        </li>
	    
	     <li  class="mb2">
          <a href="https://yx-fan.github.io/projects/push-notification-microservice-project/">Push Notification Microservice: Scalable Multi-Platform Notification System</a>
        </li>
	    
    </ul>
</div>

</aside>

  </article>

    </main>
    


<footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://yx-fan.github.io/" >
    &copy; Yuxin Fan 2024-2026
  </a>
    <div>
<div class="ananke-socials">
  
    
    <a href="https://www.linkedin.com/in/fanyuxin/" target="_blank" rel="noopener" class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" aria-label="follow on LinkedIn‚Äî‚ÄîOpens in a new window">
      
        <span class="icon"><svg style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span>
      
<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000"  xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;"/>
</svg>
</span></a>
  
</div>
</div>
  </div>
</footer>


  </body>
</html>

